require 'rubygems'
require 'bundler/setup'
require 'usb'

# Create a new USB device
device = USB::Device.new

# Set the device's product ID and vendor ID
device.product_id = 0x1234
device.vendor_id = 0x5678

# Create a new configuration for the device
config = USB::Configuration.new

# Add an interface to the configuration
interface = USB::Interface.new

# Add an endpoint to the interface
endpoint = USB::Endpoint.new(
 :direction => :in,
 :type => :bulk,
 :max_packet_size => 64
)

# Add the endpoint to the interface
interface.add_endpoint(endpoint)

# Add the interface to the configuration
config.add_interface(interface)

# Set the device's configuration
device.config = config

# Open the device
device.open

# Write some data to the device
device.write("Hello, world!")

# Close the device
device.close
